@using InsuranceSocialNetworkDTO.Banner;
@using InsuranceWebsite.Models
@model HomeViewModel

@{int bannerSpace = 1; }
@if (null != Model.SideBanners && Model.SideBanners.Count > 0)
{
    <div class="bannerPanel" id="rotator1">
        @foreach (BannerDTO banner in Model.SideBanners)
        {
            if (bannerSpace == 1)
            {
                <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
            }

            bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
        }
    </div>
    
    if (Model.SideBanners.Count > 1)
    {
        bannerSpace = 1;
        <div class="bannerPanel" id="rotator2">
            @foreach (BannerDTO banner in Model.SideBanners)
            {
                if (bannerSpace == 2)
                {
                    <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                }

                bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
            }
        </div>
    }

    if (Model.SideBanners.Count > 2)
    {
        bannerSpace = 1;
        <div class="bannerPanel" id="rotator3">
            @foreach (BannerDTO banner in Model.SideBanners)
            {
                if (bannerSpace == 3)
                {
                    <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                }

                bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
            }
        </div>
    }

    if (Model.SideBanners.Count > 5)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
                startRotator("#rotator2");
                startRotator("#rotator3");
            });

            function rotateBanners(elem) {
                var active = $(elem + " img.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " img:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " img").fadeOut(0);
                $(elem + " img:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
    else if (Model.SideBanners.Count > 4)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
                startRotator("#rotator2");
            });

            function rotateBanners(elem) {
                var active = $(elem + " img.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " img:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " img").fadeOut(0);
                $(elem + " img:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
    else if (Model.SideBanners.Count > 3)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
            });

            function rotateBanners(elem) {
                var active = $(elem + " img.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " img:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " img").fadeOut(0);
                $(elem + " img:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
}

