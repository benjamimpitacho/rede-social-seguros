@using InsuranceSocialNetworkDTO.Banner;
@using InsuranceWebsite.Models
@model HomeViewModel

@{int bannerSpace = 1; }
@if (null != Model.SideBanners && Model.SideBanners.Count > 0)
{
    <div class="bannerPanel" id="rotator1">
        @foreach (BannerDTO banner in Model.SideBanners)
        {
            <div>
                @if (bannerSpace == 1)
                {
                    if (!string.IsNullOrEmpty(banner.Url))
                    {
                    <a href="@banner.Url" target="_blank">
                        <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                    </a>
                    }
                    else
                    {
                    <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                    }
                }
            </div>

            bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
        }
    </div>
    
    if (Model.SideBanners.Count > 1)
    {
        bannerSpace = 1;
        <div class="bannerPanel" id="rotator2">
            @foreach (BannerDTO banner in Model.SideBanners)
            {
                <div>
                    @if (bannerSpace == 2)
                    {
                        if (!string.IsNullOrEmpty(banner.Url))
                        {
                        <a href="@banner.Url" target="_blank">
                            <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                        </a>
                        }
                        else
                        {
                        <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                        }
                    }
                </div>

                bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
            }
        </div>
    }

    if (Model.SideBanners.Count > 2)
    {
        bannerSpace = 1;
        <div class="bannerPanel" id="rotator3">
            @foreach (BannerDTO banner in Model.SideBanners)
            {
                <div>
                    @if (bannerSpace == 3)
                    {
                        if (!string.IsNullOrEmpty(banner.Url))
                        {
                            <a href="@banner.Url" target="_blank">
                                <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                            </a>
                        }
                        else
                        {
                            <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
                        }
                    }
                </div>

                bannerSpace = bannerSpace == 3 ? 1 : ++bannerSpace;
            }
        </div>
    }

    if (Model.SideBanners.Count > 5)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
                startRotator("#rotator2");
                startRotator("#rotator3");
            });

            function rotateBanners(elem) {
                var active = $(elem + " div.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " div:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " div").fadeOut(0);
                $(elem + " div:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
    else if (Model.SideBanners.Count > 4)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
                startRotator("#rotator2");
            });

            function rotateBanners(elem) {
                var active = $(elem + " div.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " div:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " div").fadeOut(0);
                $(elem + " div:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
    else if (Model.SideBanners.Count > 3)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator1");
            });

            function rotateBanners(elem) {
                var active = $(elem + " div.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " div:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);
            }

            function prepareRotator(elem) {
                $(elem + " div").fadeOut(0);
                $(elem + " div:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

        </script>
    }
}
else
{
    <div class="bannerPanel" id="rotator1">
        <img src="~/Content/banners/banners_rede_social_falar_seguros_AF2.png" class="bannerPanel" />
    </div>
}
