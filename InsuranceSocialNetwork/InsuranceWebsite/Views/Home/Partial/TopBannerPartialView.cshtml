@using InsuranceSocialNetworkDTO.Banner;
@using InsuranceWebsite.Models
@model HomeViewModel

@if (null != Model.TopBanners && Model.TopBanners.Count > 0)
{
    <div class="bannerPanel" id="rotator">
        @foreach (BannerDTO banner in Model.TopBanners)
        {
            <img src="@String.Format("data:image/png;base64,{0}", Convert.ToBase64String(banner.Image))" class="bannerPanel" />
        }
    </div>

    if (Model.TopBanners.Count > 1)
    {
        <script type="text/javascript">

            $(document).ready(function () {
                startRotator("#rotator");
            });

            function rotateBanners(elem) {
                var active = $(elem + " img.active");
                var next = active.next();
                if (next.length == 0)
                    next = $(elem + " img:first");
                active.removeClass("active").fadeOut(400);
                next.addClass("active").fadeIn(400);                
            }

            function prepareRotator(elem) {
                $(elem + " img").fadeOut(0);
                $(elem + " img:first").fadeIn(0).addClass("active");
            }

            function startRotator(elem) {
                prepareRotator(elem);
                setInterval("rotateBanners('" + elem + "')", 5000);
            }

            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

        </script>
    }
}

